# Прогнозирование заказов такси на основе временных рядов
[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE)

## Описание проекта

Проект посвящен разработке модели машинного обучения для прогнозирования количества заказов такси на следующий час на основе исторических данных из аэропортов. Цель - помочь компании «Чётенькое такси» оптимизировать распределение водителей в периоды пиковой нагрузки, предсказывая объем заказов с RMSE ≤ 48 на тестовой выборке.

## Основные особенности

- **Анализ данных**: Комплексный исследовательский анализ с декомпозицией временных рядов
- **Создание признаков**: Генерация временных признаков (час, день недели, выходные), лагов и скользящей статистики
- **Сравнение моделей**: Оценка нескольких моделей регрессии с подбором гиперпараметров
- **Кастомные утилиты**: Разработаны собственные функции для анализа корреляций и диагностики остатков

## Технологический стек

### Манипуляции с данными и анализ
- `pandas` для предобработки данных и ресемплинга временных рядов
- `numpy` для численных операций

### Визуализация
- `matplotlib.pyplot` и `seaborn` для статистической графики
- `phik` для анализа корреляционных матриц

### Машинное обучение
- `scikit-learn` для:
  - LinearRegression, DecisionTreeRegressor
  - TimeSeriesSplit, GridSearchCV, RandomizedSearchCV
  - Pipeline, ColumnTransformer, preprocessing
  - Метрик (RMSE, MAE, R²)
- `catboost` для CatBoostRegressor

### Статистическое моделирование
- `statsmodels` для:
  - Декомпозиции временных рядов (seasonal_decompose)
  - ACF графиков (plot_acf)
  - Анализа фактора инфляции дисперсии (VIF)
  - LOWESS сглаживания

## Кастомные утилиты

Проект включает собственные функции в `utils.py`:

### `phik_correlation_matrix()`
- Вычисляет матрицу корреляции Фи-К с автоматическим определением непрерывных столбцов
- Визуализирует тепловые карты корреляций с настраиваемыми порогами
- Возвращает коррелирующие пары признаков и корреляции с целевой переменной

### `vif()`
- Вычисляет фактор инфляции дисперсии для обнаружения мультиколлинеарности
- Создает столбчатые диаграммы значений VIF для отбора признаков

### `analyze_residuals()`
- Диагностирует остатки модели с гистограммами и диаграммами рассеяния
- Поддерживает LOWESS сглаживание для обнаружения паттернов
- Сравнивает среднее, медиану и стандартное отклонение

## Ключевые инсайты из EDA

- **Тренд**: Постоянный рост заказов такси с марта по август 2018 года
- **Суточная сезонность**: Пики спроса в 00:00, 10:00 и 16:00; минимальная активность с 00:00 до 06:00
- **Недельные паттерны**: Наибольший спрос в понедельник и пятницу; наименьший - во вторник и воскресенье
- **Эффект выходных**: Более слабые утренние пики в выходные по сравнению с буднями

## Производительность моделей

Модель Linear Regression достигла целевого показателя RMSE < 48, превзойдя как Decision Trees, так и CatBoost для данной задачи прогнозирования. Модель эффективно уловила временные паттерны, выявленные в ходе исследовательского анализа.

## Освоенные навыки

- Анализ временных рядов и декомпозиция на тренд и сезонность
- Создание признаков для временных данных (лаги, скользящие окна, временные признаки)
- Обучение и оценка моделей на временных рядах с правильной кросс-валидацией
- Статистическая диагностика и интерпретация моделей
- Оптимизация гиперпараметров для задач регрессии

## Структура проекта

```
Time-Series-Taxi-Order-Prediction/
│
├── notebooks/
│   ├── time_series_taxi_order_prediction.ipynb   # Основная тетрадка проекта
│   └── utils.py                                  # Вспомогательные функции
│
├── .gitignore
├── LICENSE
├── README.md
└── requirements.txt
```

## Возможные улучшения

- Эксперименты с дополнительными лагами и комбинациями бинарных признаков
- Борьба с переобучением через усиление регуляризации
- Тестирование альтернативных моделей временных рядов (SARIMA, Prophet, LSTM)
- Реализация ансамблевых методов для улучшения точности
